{
  "settings": {
    "color": "#6b7ed1",
    "titleTemplate": "Confirm for {{Staff}} ({{EndDate}})"
  },
  "defineJson": {
    "definitionId": "3a0e34b2-9746-6a31-4bbc-e879f2c7ea99",
    "versionId": "3a158c03-3772-89da-4043-e0e033f294f0",
    "tenantId": null,
    "name": "Probationary Confirmation Request",
    "displayName": "Probationary Confirmation Request",
    "description": null,
    "channel": null,
    "version": 43,
    "variables": {
      "data": {}
    },
    "customAttributes": {
      "data": {}
    },
    "contextOptions": null,
    "isSingleton": false,
    "persistenceBehavior": "Suspended",
    "deleteCompletedInstances": false,
    "isPublished": true,
    "isLatest": true,
    "tag": null,
    "createdAt": "2024-10-11T04:29:05.266134Z",
    "activities": [
      {
        "activityId": "27cffca9-0c3a-4ceb-a03f-27cdcbb1ca63",
        "type": "HttpEndpoint",
        "name": null,
        "displayName": "Trigger Workflow",
        "description": null,
        "persistWorkflow": false,
        "loadWorkflowContext": false,
        "saveWorkflowContext": false,
        "properties": [
          {
            "name": "Path",
            "syntax": null,
            "expressions": {
              "Literal": "probationary-request"
            }
          },
          {
            "name": "Methods",
            "syntax": null,
            "expressions": {
              "Json": "[\"POST\"]"
            }
          },
          {
            "name": "ReadContent",
            "syntax": null,
            "expressions": {
              "Literal": "true"
            }
          },
          {
            "name": "TargetType",
            "syntax": null,
            "expressions": {}
          },
          {
            "name": "Schema",
            "syntax": "Literal",
            "expressions": {
              "Literal": ""
            }
          },
          {
            "name": "Authorize",
            "syntax": null,
            "expressions": {}
          },
          {
            "name": "Policy",
            "syntax": null,
            "expressions": {}
          }
        ],
        "propertyStorageProviders": {}
      },
      {
        "activityId": "4ef62146-0984-454d-8b4b-5c52b59a6c70",
        "type": "Fork",
        "name": null,
        "displayName": "Send notifications",
        "description": null,
        "persistWorkflow": false,
        "loadWorkflowContext": false,
        "saveWorkflowContext": false,
        "properties": [
          {
            "name": "Branches",
            "syntax": null,
            "expressions": {
              "Json": "[\"To PM\",\"To Destination HoO\"]"
            }
          }
        ],
        "propertyStorageProviders": {}
      },
      {
        "activityId": "ddc141e7-56d6-4c9d-855a-b64413b4ae49",
        "type": "Fork",
        "name": null,
        "displayName": "PM Reviews",
        "description": null,
        "persistWorkflow": false,
        "loadWorkflowContext": false,
        "saveWorkflowContext": false,
        "properties": [
          {
            "name": "Branches",
            "syntax": null,
            "expressions": {
              "Json": "[\"Approve\",\"Reject\"]"
            }
          }
        ],
        "propertyStorageProviders": {}
      },
      {
        "activityId": "81183344-d77b-4da6-8f99-56f0115db182",
        "type": "Fork",
        "name": null,
        "displayName": "HoO Reviews",
        "description": null,
        "persistWorkflow": false,
        "loadWorkflowContext": false,
        "saveWorkflowContext": false,
        "properties": [
          {
            "name": "Branches",
            "syntax": null,
            "expressions": {
              "Json": "[\"Approve\",\"Reject\"]"
            }
          }
        ],
        "propertyStorageProviders": {}
      },
      {
        "activityId": "f43f49ac-6d7a-4fbd-97e0-53fc2ef793a9",
        "type": "SignalReceived",
        "name": null,
        "displayName": "Approve",
        "description": null,
        "persistWorkflow": false,
        "loadWorkflowContext": false,
        "saveWorkflowContext": false,
        "properties": [
          {
            "name": "Signal",
            "syntax": "JavaScript",
            "expressions": {
              "JavaScript": "workflowSignals.PMApproved"
            }
          }
        ],
        "propertyStorageProviders": {}
      },
      {
        "activityId": "5de08f1b-47ec-464c-9e05-2a2a4e49f598",
        "type": "SignalReceived",
        "name": null,
        "displayName": "Reject",
        "description": null,
        "persistWorkflow": false,
        "loadWorkflowContext": false,
        "saveWorkflowContext": false,
        "properties": [
          {
            "name": "Signal",
            "syntax": "JavaScript",
            "expressions": {
              "JavaScript": "workflowSignals.PMRejected"
            }
          }
        ],
        "propertyStorageProviders": {}
      },
      {
        "activityId": "e60699b7-3d61-4c87-81c4-56bd3df7c694",
        "type": "SignalReceived",
        "name": null,
        "displayName": "Approve",
        "description": null,
        "persistWorkflow": false,
        "loadWorkflowContext": false,
        "saveWorkflowContext": false,
        "properties": [
          {
            "name": "Signal",
            "syntax": "JavaScript",
            "expressions": {
              "JavaScript": "workflowSignals.HoOApproved"
            }
          }
        ],
        "propertyStorageProviders": {}
      },
      {
        "activityId": "b5cd1cb6-b5d2-420d-bc14-28e58ff805ea",
        "type": "SignalReceived",
        "name": null,
        "displayName": "Reject",
        "description": null,
        "persistWorkflow": false,
        "loadWorkflowContext": false,
        "saveWorkflowContext": false,
        "properties": [
          {
            "name": "Signal",
            "syntax": "JavaScript",
            "expressions": {
              "JavaScript": "workflowSignals.HoORejected"
            }
          }
        ],
        "propertyStorageProviders": {}
      },
      {
        "activityId": "54c65885-d560-4c75-a8a5-095e95722859",
        "type": "Join",
        "name": null,
        "displayName": "All Approved",
        "description": null,
        "persistWorkflow": false,
        "loadWorkflowContext": false,
        "saveWorkflowContext": false,
        "properties": [
          {
            "name": "Mode",
            "syntax": null,
            "expressions": {}
          }
        ],
        "propertyStorageProviders": {}
      },
      {
        "activityId": "29548d92-44ab-4db6-8553-b8542d5aeb4b",
        "type": "Join",
        "name": null,
        "displayName": "Any Rejected",
        "description": null,
        "persistWorkflow": false,
        "loadWorkflowContext": false,
        "saveWorkflowContext": false,
        "properties": [
          {
            "name": "Mode",
            "syntax": null,
            "expressions": {
              "Literal": "WaitAny"
            }
          }
        ],
        "propertyStorageProviders": {}
      },
      {
        "activityId": "3da56dbc-2270-49dd-bd7d-114579d1f61f",
        "type": "SetRequestUserVariable",
        "name": null,
        "displayName": "Set RequestUser Variable",
        "description": null,
        "persistWorkflow": false,
        "loadWorkflowContext": false,
        "saveWorkflowContext": false,
        "properties": [],
        "propertyStorageProviders": {}
      },
      {
        "activityId": "6a190599-7ac2-4e8e-9e16-d21533b7af2c",
        "type": "SendMailAndAssign",
        "name": null,
        "displayName": "PM Reviews",
        "description": null,
        "persistWorkflow": false,
        "loadWorkflowContext": false,
        "saveWorkflowContext": false,
        "properties": [
          {
            "name": "ApproveSignal",
            "syntax": "JavaScript",
            "expressions": {
              "Literal": "PMApproved",
              "JavaScript": "workflowSignals.PMApproved"
            }
          },
          {
            "name": "RejectSignal",
            "syntax": "JavaScript",
            "expressions": {
              "Literal": "PMRejected",
              "JavaScript": "workflowSignals.PMRejected"
            }
          },
          {
            "name": "To",
            "syntax": "JavaScript",
            "expressions": {
              "Json": "[]",
              "JavaScript": "const requestInfo = getVariable('Request');\r\nconst projectInfo = getProjectInfo(requestInfo.Project);\r\nconst pmsEmailAddress = [];\r\n\r\nfor (let i = 0;i < projectInfo.PM.Count;i++) {\r\n    pmsEmailAddress.push(projectInfo.PM[i].EmailAddress);\r\n}\r\n\r\nreturn pmsEmailAddress;"
            }
          },
          {
            "name": "Subject",
            "syntax": "JavaScript",
            "expressions": {
              "JavaScript": "const request = getVariable(\"Request\");\r\nconst officeInfo = getOfficeInfo(request.CurrentOffice);\r\nreturn `[Probationary Confirmation Request] [${officeInfo.displayName}] - ${request.Staff} (${new Date().toLocaleString()})`;"
            }
          },
          {
            "name": "Attachments",
            "syntax": null,
            "expressions": {}
          },
          {
            "name": "Body",
            "syntax": "JavaScript",
            "expressions": {
              "JavaScript": "const request = getVariable(\"Request\");\r\nconst officeInfo = getOfficeInfo(request.CurrentOffice);\r\nconst rejectSignalUrl = getCustomSignalUrlWithForm(workflowSignals.PMRejected, [signalInputTypes.Reason, signalInputTypes.TriggeredBy]);\r\nreturn `\r\n<head>\r\n <style>\r\n   p { margin: 0; }\r\n </style>\r\n</head>\r\n<div style=\"margin: 13px 0\"><b>Người gửi yêu cầu: </b>${getRequestUser().Name}</div>\r\n<div style=\"margin: 13px 0\"><b>Email nhân viên thử việc: </b>${request.Staff}</div>\r\n<div style=\"margin: 13px 0\"><b>Từ văn phòng: </b>${officeInfo.displayName}</div>\r\n<div style=\"margin: 13px 0\"><b>Ngày bắt đầu: </b>${request.StartDate}</div>\r\n<div style=\"margin: 13px 0\"><b>Ngày kết thúc: </b>${request.EndDate}</div>\r\n<div style=\"margin: 13px 0; display: flex\">\r\n    <b>Nội dung: </b>${request.Content}\r\n</div>\r\n<a href=\"${getCustomSignalUrl(workflowSignals.PMApproved)}\" style=\"margin-right:10px; padding: 3px 15px; background-color: #33b864; border-radius: 10px; color: white; text-decoration: none;\">Passed</a>\r\n<a href=\"${rejectSignalUrl}\" style=\"margin-right:10px; padding: 3px 15px; background-color: #FF0000; border-radius: 10px; color: white; text-decoration: none;\">Failed</a>\r\n</div>\r\n`"
            }
          },
          {
            "name": "Cc",
            "syntax": null,
            "expressions": {}
          },
          {
            "name": "Bcc",
            "syntax": null,
            "expressions": {}
          },
          {
            "name": "OtherActionSignals",
            "syntax": null,
            "expressions": {}
          },
          {
            "name": "AssignTo",
            "syntax": null,
            "expressions": {
              "Json": "[]"
            }
          },
          {
            "name": "DynamicActionData",
            "syntax": "JavaScript",
            "expressions": {
              "JavaScript": "const data = [\r\n  {\r\n    \"name\": \"StrengthPoints\",\r\n    \"type\": \"RichText\",\r\n    \"isRequired\": true,\r\n    \"data\": \"\"\r\n  },\r\n  {\r\n    \"name\": \"WeaknessPoints\",\r\n    \"type\": \"RichText\",\r\n    \"isRequired\": true,\r\n    \"data\": \"\"\r\n  }\r\n];\r\n\r\nreturn JSON.stringify(data);"
            }
          }
        ],
        "propertyStorageProviders": {}
      },
      {
        "activityId": "fd3ca6e4-2e85-438e-b946-3c8185f5f1cd",
        "type": "SendMailAndAssign",
        "name": null,
        "displayName": "HoO Reviews",
        "description": null,
        "persistWorkflow": false,
        "loadWorkflowContext": false,
        "saveWorkflowContext": false,
        "properties": [
          {
            "name": "ApproveSignal",
            "syntax": "JavaScript",
            "expressions": {
              "Literal": "HoOApproved",
              "JavaScript": "workflowSignals.HoOApproved"
            }
          },
          {
            "name": "RejectSignal",
            "syntax": "JavaScript",
            "expressions": {
              "Literal": "HoORejected",
              "JavaScript": "workflowSignals.HoORejected"
            }
          },
          {
            "name": "To",
            "syntax": "JavaScript",
            "expressions": {
              "Json": "[]",
              "JavaScript": "const currentHoOEmail = getOfficeInfo(getVariable(\"Request\").CurrentOffice)?.headOfOfficeEmail;\r\n\r\nreturn [currentHoOEmail];"
            }
          },
          {
            "name": "Subject",
            "syntax": "JavaScript",
            "expressions": {
              "JavaScript": "const request = getVariable(\"Request\");\r\nconst officeInfo = getOfficeInfo(request.CurrentOffice);\r\n\r\nreturn `[Probationary Confirmation Request] [${officeInfo.displayName}] - ${request.Staff} (${new Date().toLocaleString()})`;"
            }
          },
          {
            "name": "Attachments",
            "syntax": null,
            "expressions": {}
          },
          {
            "name": "Body",
            "syntax": "JavaScript",
            "expressions": {
              "JavaScript": "const request = getVariable(\"Request\");\r\nconst officeInfo = getOfficeInfo(request.CurrentOffice);\r\nconst rejectSignalUrl = getCustomSignalUrlWithForm(workflowSignals.HoORejected, [signalInputTypes.Reason, signalInputTypes.TriggeredBy]);\r\nreturn `\r\n<head>\r\n <style>\r\n   p { margin: 0; }\r\n </style>\r\n</head>\r\n<div style=\"margin: 13px 0\"><b>Người gửi yêu cầu: </b>${getRequestUser().Name}</div>\r\n<div style=\"margin: 13px 0\"><b>Email nhân viên thử việc: </b>${request.Staff}</div>\r\n<div style=\"margin: 13px 0\"><b>Từ văn phòng: </b>${officeInfo.displayName}</div>\r\n<div style=\"margin: 13px 0\"><b>Ngày bắt đầu: </b>${request.StartDate}</div>\r\n<div style=\"margin: 13px 0\"><b>Ngày kết thúc: </b>${request.EndDate}</div>\r\n<div style=\"margin: 13px 0; display: flex\">\r\n    <b>Nội dung: </b>${request.Content}\r\n</div>\r\n<a href=\"${getCustomSignalUrl(workflowSignals.HoOApproved)}\" style=\"margin-right:10px; padding: 3px 15px; background-color: #33b864; border-radius: 10px; color: white; text-decoration: none;\">Passed</a>\r\n<a href=\"${rejectSignalUrl}\" style=\"margin-right:10px; padding: 3px 15px; background-color: #FF0000; border-radius: 10px; color: white; text-decoration: none;\">Failed</a>\r\n</div>\r\n`"
            }
          },
          {
            "name": "Cc",
            "syntax": null,
            "expressions": {}
          },
          {
            "name": "Bcc",
            "syntax": null,
            "expressions": {}
          },
          {
            "name": "OtherActionSignals",
            "syntax": null,
            "expressions": {}
          },
          {
            "name": "AssignTo",
            "syntax": null,
            "expressions": {
              "Json": "[]"
            }
          },
          {
            "name": "DynamicActionData",
            "syntax": "JavaScript",
            "expressions": {
              "JavaScript": "const data = [\r\n  {\r\n    \"name\": \"StrengthPoints\",\r\n    \"type\": \"RichText\",\r\n    \"isRequired\": true,\r\n    \"data\": \"\"\r\n  },\r\n  {\r\n    \"name\": \"WeaknessPoints\",\r\n    \"type\": \"RichText\",\r\n    \"isRequired\": true,\r\n    \"data\": \"\"\r\n  }\r\n];\r\n\r\nreturn JSON.stringify(data);"
            }
          }
        ],
        "propertyStorageProviders": {}
      },
      {
        "activityId": "6de15f43-c67b-4b73-b648-07cf1786aff0",
        "type": "SendMailAndAssign",
        "name": null,
        "displayName": "CEO Reviews",
        "description": null,
        "persistWorkflow": false,
        "loadWorkflowContext": false,
        "saveWorkflowContext": false,
        "properties": [
          {
            "name": "ApproveSignal",
            "syntax": "JavaScript",
            "expressions": {
              "JavaScript": "workflowSignals.CEOApproved"
            }
          },
          {
            "name": "RejectSignal",
            "syntax": "JavaScript",
            "expressions": {
              "JavaScript": "workflowSignals.CEORejected"
            }
          },
          {
            "name": "DynamicActionData",
            "syntax": null,
            "expressions": {
              "JavaScript": "",
              "Literal": ""
            }
          },
          {
            "name": "OtherActionSignals",
            "syntax": null,
            "expressions": {}
          },
          {
            "name": "AssignTo",
            "syntax": "JavaScript",
            "expressions": {
              "Json": "[]",
              "JavaScript": "const requestUser = getVariable('RequestUser');\r\nconst ceoEmails = requestUser.CEOEmails; \r\n\r\nreturn ceoEmails;\r\n"
            }
          },
          {
            "name": "To",
            "syntax": "JavaScript",
            "expressions": {
              "Json": "[]",
              "JavaScript": "const requestUser = getVariable('RequestUser');\r\nconst ceoEmails = requestUser.CEOEmails; \r\n\r\nreturn ceoEmails;\r\n"
            }
          },
          {
            "name": "Subject",
            "syntax": "JavaScript",
            "expressions": {
              "JavaScript": "const request = getVariable(\"Request\");\r\nconst officeInfo = getOfficeInfo(request.CurrentOffice);\r\nreturn `[Probationary Confirmation Request] [${officeInfo.displayName}] - ${request.Staff} (${new Date().toLocaleString()})`;"
            }
          },
          {
            "name": "Attachments",
            "syntax": null,
            "expressions": {}
          },
          {
            "name": "Body",
            "syntax": "JavaScript",
            "expressions": {
              "JavaScript": "const request = getVariable(\"Request\");\r\nconst officeInfo = getOfficeInfo(request.CurrentOffice);\r\nconst rejectSignalUrl = getCustomSignalUrlWithForm(workflowSignals.CEORejected, [signalInputTypes.Reason, signalInputTypes.TriggeredBy]);\r\nreturn `\r\n<head>\r\n <style>\r\n   p { margin: 0; }\r\n </style>\r\n</head>\r\n<div style=\"margin: 13px 0\"><b>Người gửi yêu cầu: </b>${getRequestUser().Name}</div>\r\n<div style=\"margin: 13px 0\"><b>Email nhân viên thử việc: </b>${request.Staff}</div>\r\n<div style=\"margin: 13px 0\"><b>Từ văn phòng: </b>${officeInfo?.displayName}</div>\r\n<div style=\"margin: 13px 0\"><b>Ngày bắt đầu: </b>${request.StartDate}</div>\r\n<div style=\"margin: 13px 0\"><b>Ngày kết thúc: </b>${request.EndDate}</div>\r\n<div style=\"margin: 13px 0; display: flex\">\r\n    <b>Nội dung: </b>${request.Content}\r\n</div>\r\n<div style=\"margin: 13px 0\">\r\n  <p><b>Điểm mạnh: </b></p>\r\n  {StrengthPoints}\r\n</div>\r\n<div style=\"margin: 13px 0\">\r\n  <p><b>Điểm yếu: </b></p>\r\n  {WeaknessPoints}\r\n</div>\r\n<a href=\"${getCustomSignalUrl(workflowSignals.CEOApproved)}\" style=\"margin-right:10px; padding: 3px 15px; background-color: #33b864; border-radius: 10px; color: white; text-decoration: none;\">Passed</a>\r\n<a href=\"${rejectSignalUrl}\" style=\"margin-right:10px; padding: 3px 15px; background-color: #FF0000; border-radius: 10px; color: white; text-decoration: none;\">Failed</a>\r\n</div>\r\n`"
            }
          },
          {
            "name": "Cc",
            "syntax": null,
            "expressions": {}
          },
          {
            "name": "Bcc",
            "syntax": null,
            "expressions": {}
          }
        ],
        "propertyStorageProviders": {}
      },
      {
        "activityId": "68fff0f8-c5d6-426c-9aa6-ec5a283f338a",
        "type": "Fork",
        "name": null,
        "displayName": "CEO Reviews",
        "description": null,
        "persistWorkflow": false,
        "loadWorkflowContext": false,
        "saveWorkflowContext": false,
        "properties": [
          {
            "name": "Branches",
            "syntax": null,
            "expressions": {
              "Json": "[\"Approve\",\"Reject\"]"
            }
          }
        ],
        "propertyStorageProviders": {}
      },
      {
        "activityId": "51de859a-4b39-4040-86a4-2f46f2b9cb17",
        "type": "SignalReceived",
        "name": null,
        "displayName": "Approved",
        "description": null,
        "persistWorkflow": false,
        "loadWorkflowContext": false,
        "saveWorkflowContext": false,
        "properties": [
          {
            "name": "Signal",
            "syntax": "JavaScript",
            "expressions": {
              "JavaScript": "workflowSignals.CEOApproved"
            }
          }
        ],
        "propertyStorageProviders": {}
      },
      {
        "activityId": "c9fe8676-061f-414c-8c2c-f018ffd93006",
        "type": "SignalReceived",
        "name": null,
        "displayName": "Rejected",
        "description": null,
        "persistWorkflow": false,
        "loadWorkflowContext": false,
        "saveWorkflowContext": false,
        "properties": [
          {
            "name": "Signal",
            "syntax": "JavaScript",
            "expressions": {
              "JavaScript": "workflowSignals.CEORejected"
            }
          }
        ],
        "propertyStorageProviders": {}
      },
      {
        "activityId": "9256e41f-acd2-4675-a9fa-2c8e56630756",
        "type": "CustomEmail",
        "name": null,
        "displayName": "Notice Approve",
        "description": null,
        "persistWorkflow": false,
        "loadWorkflowContext": false,
        "saveWorkflowContext": false,
        "properties": [
          {
            "name": "To",
            "syntax": null,
            "expressions": {
              "Json": "[\"it@ncc.asia\"]"
            }
          },
          {
            "name": "Subject",
            "syntax": "JavaScript",
            "expressions": {
              "JavaScript": "const request = getVariable(\"Request\");\r\nconst officeInfo = getOfficeInfo(request.CurrentOffice);\r\nreturn `[Probationary Confirmation Request] [Approved] - [${officeInfo?.displayName}] - ${request.Staff} (${new Date().toLocaleString()})`;"
            }
          },
          {
            "name": "Attachments",
            "syntax": null,
            "expressions": {}
          },
          {
            "name": "Body",
            "syntax": "JavaScript",
            "expressions": {
              "JavaScript": "const request = getVariable(\"Request\");\r\nconst officeInfo = getOfficeInfo(request.CurrentOffice);\r\nreturn `\r\n<head>\r\n <style>\r\n   p { margin: 0; }\r\n </style>\r\n</head>\r\n<div style=\"margin: 13px 0\"><b>Yêu cầu thử việc đã được chấp nhận!</b></div>\r\n<div style=\"margin: 13px 0\"><b>Lý do: </b>${activityExecutionContext.Input.Reason}</div>\r\n<div style=\"margin: 13px 0\">Chấp nhận bởi: ${activityExecutionContext.Input.TriggeredBy}</div>\r\n<div style=\"padding: 3px 10px; border-radius: 10px; background-color: aliceblue\">\r\n  <div style=\"margin: 13px 0\"><i>Nội dung request</i></div>\r\n  <div style=\"margin: 13px 0\"><b>Người gửi yêu cầu: </b>${getRequestUser().Name}</div>\r\n  <div style=\"margin: 13px 0\"><b>Email nhân viên thử việc: </b>${request.Staff}</div>\r\n  <div style=\"margin: 13px 0\"><b>Từ văn phòng: </b>${officeInfo?.displayName}</div>\r\n  <div style=\"margin: 13px 0\"><b>Ngày bắt đầu: </b>${request.StartDate}</div>\r\n  <div style=\"margin: 13px 0\"><b>Ngày kết thúc: </b>${request.EndDate}</div>\r\n  <div style=\"margin: 13px 0; display: flex\">\r\n    <b>Nội dung:</b>&#160;${request.Content}\r\n  </div>\r\n</div>\r\n`"
            }
          },
          {
            "name": "Cc",
            "syntax": null,
            "expressions": {}
          },
          {
            "name": "Bcc",
            "syntax": null,
            "expressions": {}
          }
        ],
        "propertyStorageProviders": {}
      },
      {
        "activityId": "a496c8b6-7e7a-4f4c-b8e7-058879777742",
        "type": "CustomEmail",
        "name": null,
        "displayName": "Notice Reject",
        "description": null,
        "persistWorkflow": false,
        "loadWorkflowContext": false,
        "saveWorkflowContext": false,
        "properties": [
          {
            "name": "To",
            "syntax": null,
            "expressions": {
              "Json": "[\"it@ncc.asia\"]"
            }
          },
          {
            "name": "Subject",
            "syntax": "JavaScript",
            "expressions": {
              "JavaScript": "const request = getVariable(\"Request\");\r\nconst officeInfo = getOfficeInfo(request.CurrentOffice);\r\nreturn `[Probationary Confirmation Request][Rejected] - [${officeInfo?.displayName}] - ${request.Staff} (${new Date().toLocaleString()})`;"
            }
          },
          {
            "name": "Attachments",
            "syntax": null,
            "expressions": {}
          },
          {
            "name": "Body",
            "syntax": "JavaScript",
            "expressions": {
              "JavaScript": "const request = getVariable(\"Request\");\r\nconst officeInfo = getOfficeInfo(request.CurrentOffice);\r\nreturn `\r\n<head>\r\n <style>\r\n   p { margin: 0; }\r\n </style>\r\n</head>\r\n<div style=\"margin: 13px 0\"><b>Yêu cầu thử việc đã bị từ chối!</b></div>\r\n<div style=\"margin: 13px 0\"><b>Lý do: </b>${activityExecutionContext.Input.Reason}</div>\r\n<div style=\"margin: 13px 0\">Từ chối bởi: ${activityExecutionContext.Input.TriggeredBy}</div>\r\n<div style=\"padding: 3px 10px; border-radius: 10px; background-color: aliceblue\">\r\n  <div style=\"margin: 13px 0\"><i>Nội dung request</i></div>\r\n  <div style=\"margin: 13px 0\"><b>Người gửi yêu cầu: </b>${getRequestUser().Name}</div>\r\n  <div style=\"margin: 13px 0\"><b>Email nhân viên thử việc: </b>${request.Staff}</div>\r\n  <div style=\"margin: 13px 0\"><b>Từ văn phòng: </b>${officeInfo?.displayName}</div>\r\n  <div style=\"margin: 13px 0\"><b>Ngày bắt đầu: </b>${request.StartDate}</div>\r\n  <div style=\"margin: 13px 0\"><b>Ngày kết thúc: </b>${request.EndDate}</div>\r\n  <div style=\"margin: 13px 0; display: flex\">\r\n    <b>Nội dung:</b>&#160;${request.Content}\r\n  </div>\r\n</div>\r\n`"
            }
          },
          {
            "name": "Cc",
            "syntax": null,
            "expressions": {}
          },
          {
            "name": "Bcc",
            "syntax": null,
            "expressions": {}
          }
        ],
        "propertyStorageProviders": {}
      },
      {
        "activityId": "9c62f3d6-13d4-41a2-b5a0-0d8201573dea",
        "type": "StartAt",
        "name": null,
        "displayName": "Reminder",
        "description": null,
        "persistWorkflow": false,
        "loadWorkflowContext": false,
        "saveWorkflowContext": false,
        "properties": [
          {
            "name": "Instant",
            "syntax": "JavaScript",
            "expressions": {
              "JavaScript": "function convertDateFormat(inputDate) {\r\n  const parts = inputDate.split(\"/\");\r\n  const day = parts[0];\r\n  const month = parts[1];\r\n  const year = parts[2];\r\n\r\n  return `${month}/${day}/${year}`;\r\n}\r\n\r\nlet timeInTicks = 600000000;\r\nconst request = getVariable(\"Request\");\r\nconst initEndDate = convertDateFormat(request.EndDate);\r\nconst currentDate = new Date();\r\nconst endDate = new Date(initEndDate);\r\n\r\nif (endDate > new Date(currentDate.getTime() + 7 * 24 * 60 * 60 * 1000)) {\r\n  // Trừ 7 ngày từ endDate\r\n  endDate.setDate(endDate.getDate() - 7);\r\n\r\n  // Tính khoảng thời gian từ currentDate đến endDate theo phút\r\n  const timeDifferenceInMinutes = Math.round((endDate - currentDate) / (1000 * 60));\r\n\r\n  // Nếu là ngày trong tương lai: chuyển đổi sang số tick (1 tick = 1 phút = 600,000,000)\r\n  timeInTicks = timeDifferenceInMinutes > 0 ? timeDifferenceInMinutes * 600000000 : timeInTicks;\r\n}\r\n\r\nconst intDate = currentInstant();\r\nconst triggeredDate = intDate.PlusTicks(timeInTicks);\r\nreturn triggeredDate;\r\n"
            }
          }
        ],
        "propertyStorageProviders": {}
      },
      {
        "activityId": "f62bcf04-1b11-47cf-aa3b-19413da672bb",
        "type": "CustomEmail",
        "name": null,
        "displayName": "Notice Reject",
        "description": null,
        "persistWorkflow": false,
        "loadWorkflowContext": false,
        "saveWorkflowContext": false,
        "properties": [
          {
            "name": "To",
            "syntax": null,
            "expressions": {
              "Json": "[\"it@ncc.asia\"]"
            }
          },
          {
            "name": "Subject",
            "syntax": "JavaScript",
            "expressions": {
              "JavaScript": "const request = getVariable(\"Request\");\r\nconst officeInfo = getOfficeInfo(request.CurrentOffice);\r\nreturn `[Probationary Confirmation Request][Rejected] - [${officeInfo?.displayName}] - ${request.Staff} (${new Date().toLocaleString()})`;"
            }
          },
          {
            "name": "Attachments",
            "syntax": null,
            "expressions": {}
          },
          {
            "name": "Body",
            "syntax": "JavaScript",
            "expressions": {
              "JavaScript": "const request = getVariable(\"Request\");\r\nconst officeInfo = getOfficeInfo(request.CurrentOffice);\r\nreturn `\r\n<head>\r\n <style>\r\n   p { margin: 0; }\r\n </style>\r\n</head>\r\n<div style=\"margin: 13px 0\"><b>Yêu cầu thử việc đã bị từ chối!</b></div>\r\n<div style=\"margin: 13px 0\"><b>Lý do: </b>${activityExecutionContext.Input.Reason}</div>\r\n<div style=\"margin: 13px 0\">Từ chối bởi: ${activityExecutionContext.Input.TriggeredBy}</div>\r\n<div style=\"padding: 3px 10px; border-radius: 10px; background-color: aliceblue\">\r\n  <div style=\"margin: 13px 0\"><i>Nội dung request</i></div>\r\n  <div style=\"margin: 13px 0\"><b>Người gửi yêu cầu: </b>${getRequestUser().Name}</div>\r\n  <div style=\"margin: 13px 0\"><b>Email nhân viên thử việc: </b>${request.Staff}</div>\r\n  <div style=\"margin: 13px 0\"><b>Từ văn phòng: </b>${officeInfo?.displayName}</div>\r\n  <div style=\"margin: 13px 0\"><b>Ngày bắt đầu: </b>${request.StartDate}</div>\r\n  <div style=\"margin: 13px 0\"><b>Ngày kết thúc: </b>${request.EndDate}</div>\r\n  <div style=\"margin: 13px 0; display: flex\">\r\n    <b>Nội dung:</b>&#160;${request.Content}\r\n  </div>\r\n</div>\r\n`"
            }
          },
          {
            "name": "Cc",
            "syntax": null,
            "expressions": {}
          },
          {
            "name": "Bcc",
            "syntax": null,
            "expressions": {}
          }
        ],
        "propertyStorageProviders": {}
      },
      {
        "activityId": "35bb8f5f-e4ce-4ba7-89f8-d4ca0e6e6361",
        "type": "W2RejectedPreFinish",
        "name": null,
        "displayName": "W2 Rejected Pre Finish",
        "description": null,
        "persistWorkflow": false,
        "loadWorkflowContext": false,
        "saveWorkflowContext": false,
        "properties": [],
        "propertyStorageProviders": {}
      },
      {
        "activityId": "6e28823d-3b5b-4db7-8518-7706482c0dc2",
        "type": "Finish",
        "name": null,
        "displayName": "Finish",
        "description": null,
        "persistWorkflow": false,
        "loadWorkflowContext": false,
        "saveWorkflowContext": false,
        "properties": [
          {
            "name": "ActivityOutput",
            "syntax": null,
            "expressions": {
              "Literal": "Done"
            }
          },
          {
            "name": "OutcomeNames",
            "syntax": null,
            "expressions": {}
          }
        ],
        "propertyStorageProviders": {}
      },
      {
        "activityId": "bf2b9f74-9e74-46b9-862a-330b915dc717",
        "type": "W2ApprovedPreFinish",
        "name": null,
        "displayName": "W2 Approved Pre Finish",
        "description": null,
        "persistWorkflow": false,
        "loadWorkflowContext": false,
        "saveWorkflowContext": false,
        "properties": [],
        "propertyStorageProviders": {}
      },
      {
        "activityId": "0c5da5c4-fa82-4a2b-8415-481e266493d2",
        "type": "W2RejectedPreFinish",
        "name": null,
        "displayName": "W2 Rejected Pre Finish",
        "description": null,
        "persistWorkflow": false,
        "loadWorkflowContext": false,
        "saveWorkflowContext": false,
        "properties": [],
        "propertyStorageProviders": {}
      },
      {
        "activityId": "e1bfd0e0-c10d-4933-8452-c8421390d928",
        "type": "Finish",
        "name": null,
        "displayName": "Finish",
        "description": null,
        "persistWorkflow": false,
        "loadWorkflowContext": false,
        "saveWorkflowContext": false,
        "properties": [
          {
            "name": "ActivityOutput",
            "syntax": null,
            "expressions": {
              "Literal": "Done"
            }
          },
          {
            "name": "OutcomeNames",
            "syntax": null,
            "expressions": {}
          }
        ],
        "propertyStorageProviders": {}
      },
      {
        "activityId": "adf2f719-e5f6-4571-b87f-62f8a26ea18f",
        "type": "Finish",
        "name": null,
        "displayName": "Finish",
        "description": null,
        "persistWorkflow": false,
        "loadWorkflowContext": false,
        "saveWorkflowContext": false,
        "properties": [
          {
            "name": "ActivityOutput",
            "syntax": null,
            "expressions": {
              "Literal": "Done"
            }
          },
          {
            "name": "OutcomeNames",
            "syntax": null,
            "expressions": {}
          }
        ],
        "propertyStorageProviders": {}
      }
    ],
    "connections": [
      {
        "sourceActivityId": "ddc141e7-56d6-4c9d-855a-b64413b4ae49",
        "targetActivityId": "f43f49ac-6d7a-4fbd-97e0-53fc2ef793a9",
        "outcome": "Approve"
      },
      {
        "sourceActivityId": "ddc141e7-56d6-4c9d-855a-b64413b4ae49",
        "targetActivityId": "5de08f1b-47ec-464c-9e05-2a2a4e49f598",
        "outcome": "Reject"
      },
      {
        "sourceActivityId": "81183344-d77b-4da6-8f99-56f0115db182",
        "targetActivityId": "e60699b7-3d61-4c87-81c4-56bd3df7c694",
        "outcome": "Approve"
      },
      {
        "sourceActivityId": "81183344-d77b-4da6-8f99-56f0115db182",
        "targetActivityId": "b5cd1cb6-b5d2-420d-bc14-28e58ff805ea",
        "outcome": "Reject"
      },
      {
        "sourceActivityId": "f43f49ac-6d7a-4fbd-97e0-53fc2ef793a9",
        "targetActivityId": "54c65885-d560-4c75-a8a5-095e95722859",
        "outcome": "Done"
      },
      {
        "sourceActivityId": "e60699b7-3d61-4c87-81c4-56bd3df7c694",
        "targetActivityId": "54c65885-d560-4c75-a8a5-095e95722859",
        "outcome": "Done"
      },
      {
        "sourceActivityId": "b5cd1cb6-b5d2-420d-bc14-28e58ff805ea",
        "targetActivityId": "29548d92-44ab-4db6-8553-b8542d5aeb4b",
        "outcome": "Done"
      },
      {
        "sourceActivityId": "4ef62146-0984-454d-8b4b-5c52b59a6c70",
        "targetActivityId": "6a190599-7ac2-4e8e-9e16-d21533b7af2c",
        "outcome": "To PM"
      },
      {
        "sourceActivityId": "4ef62146-0984-454d-8b4b-5c52b59a6c70",
        "targetActivityId": "fd3ca6e4-2e85-438e-b946-3c8185f5f1cd",
        "outcome": "To Destination HoO"
      },
      {
        "sourceActivityId": "54c65885-d560-4c75-a8a5-095e95722859",
        "targetActivityId": "6de15f43-c67b-4b73-b648-07cf1786aff0",
        "outcome": "Done"
      },
      {
        "sourceActivityId": "6de15f43-c67b-4b73-b648-07cf1786aff0",
        "targetActivityId": "68fff0f8-c5d6-426c-9aa6-ec5a283f338a",
        "outcome": "Done"
      },
      {
        "sourceActivityId": "68fff0f8-c5d6-426c-9aa6-ec5a283f338a",
        "targetActivityId": "51de859a-4b39-4040-86a4-2f46f2b9cb17",
        "outcome": "Approve"
      },
      {
        "sourceActivityId": "68fff0f8-c5d6-426c-9aa6-ec5a283f338a",
        "targetActivityId": "c9fe8676-061f-414c-8c2c-f018ffd93006",
        "outcome": "Reject"
      },
      {
        "sourceActivityId": "5de08f1b-47ec-464c-9e05-2a2a4e49f598",
        "targetActivityId": "29548d92-44ab-4db6-8553-b8542d5aeb4b",
        "outcome": "Done"
      },
      {
        "sourceActivityId": "51de859a-4b39-4040-86a4-2f46f2b9cb17",
        "targetActivityId": "9256e41f-acd2-4675-a9fa-2c8e56630756",
        "outcome": "Done"
      },
      {
        "sourceActivityId": "c9fe8676-061f-414c-8c2c-f018ffd93006",
        "targetActivityId": "a496c8b6-7e7a-4f4c-b8e7-058879777742",
        "outcome": "Done"
      },
      {
        "sourceActivityId": "3da56dbc-2270-49dd-bd7d-114579d1f61f",
        "targetActivityId": "9c62f3d6-13d4-41a2-b5a0-0d8201573dea",
        "outcome": "Done"
      },
      {
        "sourceActivityId": "9c62f3d6-13d4-41a2-b5a0-0d8201573dea",
        "targetActivityId": "4ef62146-0984-454d-8b4b-5c52b59a6c70",
        "outcome": "Done"
      },
      {
        "sourceActivityId": "6a190599-7ac2-4e8e-9e16-d21533b7af2c",
        "targetActivityId": "ddc141e7-56d6-4c9d-855a-b64413b4ae49",
        "outcome": "Done"
      },
      {
        "sourceActivityId": "fd3ca6e4-2e85-438e-b946-3c8185f5f1cd",
        "targetActivityId": "81183344-d77b-4da6-8f99-56f0115db182",
        "outcome": "Done"
      },
      {
        "sourceActivityId": "29548d92-44ab-4db6-8553-b8542d5aeb4b",
        "targetActivityId": "f62bcf04-1b11-47cf-aa3b-19413da672bb",
        "outcome": "Done"
      },
      {
        "sourceActivityId": "f62bcf04-1b11-47cf-aa3b-19413da672bb",
        "targetActivityId": "35bb8f5f-e4ce-4ba7-89f8-d4ca0e6e6361",
        "outcome": "Done"
      },
      {
        "sourceActivityId": "35bb8f5f-e4ce-4ba7-89f8-d4ca0e6e6361",
        "targetActivityId": "6e28823d-3b5b-4db7-8518-7706482c0dc2",
        "outcome": "Done"
      },
      {
        "sourceActivityId": "9256e41f-acd2-4675-a9fa-2c8e56630756",
        "targetActivityId": "bf2b9f74-9e74-46b9-862a-330b915dc717",
        "outcome": "Done"
      },
      {
        "sourceActivityId": "a496c8b6-7e7a-4f4c-b8e7-058879777742",
        "targetActivityId": "0c5da5c4-fa82-4a2b-8415-481e266493d2",
        "outcome": "Done"
      },
      {
        "sourceActivityId": "bf2b9f74-9e74-46b9-862a-330b915dc717",
        "targetActivityId": "e1bfd0e0-c10d-4933-8452-c8421390d928",
        "outcome": "Done"
      },
      {
        "sourceActivityId": "0c5da5c4-fa82-4a2b-8415-481e266493d2",
        "targetActivityId": "adf2f719-e5f6-4571-b87f-62f8a26ea18f",
        "outcome": "Done"
      },
      {
        "sourceActivityId": "27cffca9-0c3a-4ceb-a03f-27cdcbb1ca63",
        "targetActivityId": "3da56dbc-2270-49dd-bd7d-114579d1f61f",
        "outcome": "Done"
      }
    ],
    "id": "3a158c03-3772-89da-4043-e0e033f294f0"
  },
  "propertyDefinitions": [
    {
      "name": "Staff",
      "type": "UserList",
      "isRequired": true,
      "id": "9d47e0ff-dc61-49d7-81f9-b65a4dde2c76"
    },
    {
      "name": "Project",
      "type": "MyProject",
      "isRequired": true,
      "id": "d9bc44c7-3a9d-46a9-85e7-e15a7fb5af46"
    },
    {
      "name": "CurrentOffice",
      "type": "OfficeList",
      "isRequired": true,
      "id": "7a84185d-e412-4e7d-8fab-d3470cf9b8be"
    },
    {
      "name": "Content",
      "type": "RichText",
      "isRequired": true,
      "id": "e93dd46a-d1f5-4b28-b833-0b8f557a0283"
    },
    {
      "name": "StartDate",
      "type": "DateTime",
      "isRequired": true,
      "id": "d8e715ff-979b-4352-8893-21c0ef25c599"
    },
    {
      "name": "EndDate",
      "type": "DateTime",
      "isRequired": true,
      "id": "4a19ba3e-7d37-4bee-b4d3-4c2142b65965"
    }
  ]
}
